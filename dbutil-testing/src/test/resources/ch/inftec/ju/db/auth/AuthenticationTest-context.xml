<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:p="http://www.springframework.org/schema/p"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security-3.1.xsd">

	<authentication-manager>
		<authentication-provider user-service-ref="juUserDetailsService"/>
	</authentication-manager>
	
	<!-- Set the security strategy to MODE_GLOBAL -->
	<beans:bean
		class="org.springframework.beans.factory.config.MethodInvokingFactoryBean"
		p:targetClass="org.springframework.security.core.context.SecurityContextHolder"
		p:targetMethod="setStrategyName" p:arguments="MODE_GLOBAL" />
	
	<!-- Custom Authentication Provider -->
	<beans:bean
		id="juUserDetailsService" 
		class="ch.inftec.ju.db.auth.JuUserDetailsService"/>
	
	<!-- Define a test implementation for UnknownUserHandler -->
	<beans:bean
		id="myUnknownUserHandler"
		class="ch.inftec.ju.db.auth.MyUnknownUserHandler"/>
	
	<!-- Define DbConnection hooks -->	
	
	<beans:bean
		id="dbConnectionFactory"
		class="ch.inftec.ju.db.DbConnectionFactoryLoader"
		factory-method="createInstance">
		<beans:constructor-arg><beans:value>/META-INF/authPersistence.xml</beans:value></beans:constructor-arg>	
	</beans:bean>
	
	<beans:bean
		id="dbConnection"
		factory-bean="dbConnectionFactory"
		factory-method="openDbConnection">
		<beans:constructor-arg><beans:value>Derby InMemory-DB</beans:value></beans:constructor-arg>
	</beans:bean>
</beans:beans>